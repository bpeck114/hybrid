Warning(sock.c:515): connect locally (/home/bpeck/.aos/tmp/anshar/scheduler) failed: Connection refused. 
/scr2/bpeck/work/hybrid/maos -o test -c A_hybrid.conf -O 
Output folder is 'test'.
SRC: /usr/local/src/maos v2.8.1 071e2afe 2023-06-02 20:48:10 -0700
BUILT: /usr/local/test_maos by GCC (8) on 2023/08/18 16:11:06 CPU(double) +CUDA(single) +optimization.
Launched at 2024/06/04 16:04:31 in anshar with PID 592108.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /scr2/bpeck/work/hybrid/A_hybrid.conf
addpath bin
addpath atm
loaded 139 (139 new) records from '/scr2/bpeck/work/hybrid/./keck_sim.conf'
loaded  19 ( 19 new) records from '/scr2/bpeck/work/hybrid/./keck_dm_single.conf'
loaded   7 (  5 new) records from '/scr2/bpeck/work/hybrid/./atm_mk13n50p_ground_detail.conf'
Found multiple powfs_none.conf at /scr2/bpeck/work/hybrid/./powfs_none.conf, /usr/local/src/maos/config/maos/powfs_none.conf. Will use the first one found.
loaded  69 ( 69 new) records from '/usr/local/src/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/scr2/bpeck/work/hybrid/./powfs_none.conf'
loaded  45 (  0 new) records from '/scr2/bpeck/work/hybrid/./keck_shwfs_lgs.conf'
loaded  46 (  0 new) records from '/scr2/bpeck/work/hybrid/./keck_shwfs_lgs_R20.conf'
loaded  45 (  0 new) records from '/scr2/bpeck/work/hybrid/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/scr2/bpeck/work/hybrid/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/scr2/bpeck/work/hybrid/./keck_wfs_hybrid_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/usr/local/src/maos/config/maos/recon.conf'
loaded  88 ( 88 new) records from '/usr/local/src/maos/config/maos/dbg.conf'
loaded   4 (  4 new) records from '/usr/local/src/maos/config/maos/fit_oa.conf'
loaded  35 ( 10 new) records from '/scr2/bpeck/work/hybrid/A_hybrid.conf'
loaded   0 (  0 new) records from 'command line'
atm.wddeg=0: fill 1 to 14 by value in 0
atm.L0=30: fill 1 to 14 by value in 0
powfs.sigrecon=[0]: fill 1 to 4 by value in 0
powfs.saloc=[""]: Fill 1 to 4 by value in 0
powfs.amp=[""]: Fill 1 to 4 by value in 0
powfs.piinfile=[""]: Fill 1 to 4 by value in 0
powfs.sninfile=[""]: Fill 1 to 4 by value in 0
powfs.safill2d=[1]: fill 1 to 4 by value in 0
powfs.saspherical=[0]: fill 1 to 4 by value in 0
powfs.safocuspv=[0]: fill 1 to 4 by value in 0
powfs.neaphy=[0]: fill 1 to 4 by value in 0
powfs.neareconfile=[""]: Fill 1 to 4 by value in 0
powfs.neasimfile=[""]: Fill 1 to 4 by value in 0
powfs.neasim=[-1]: fill 1 to 4 by value in 0
powfs.neaextra=[0]: fill 1 to 4 by value in 0
powfs.neamin=[0]: fill 1 to 4 by value in 0
powfs.bkgrndc=[1]: fill 1 to 4 by value in 0
powfs.bkgrndfn=[""]: Fill 1 to 4 by value in 0
powfs.bkgrndfnc=[""]: Fill 1 to 4 by value in 0
powfs.radpixtheta=[0]: fill 1 to 4 by value in 0
powfs.pixoffx=[0]: fill 1 to 4 by value in 0
powfs.pixoffy=[0]: fill 1 to 4 by value in 0
powfs.phyusenea=[-1]: fill 1 to 4 by value in 0
powfs.radpix=[0]: fill 1 to 4 by value in 0
powfs.radgx=[1]: fill 1 to 4 by value in 0
powfs.embfac=[2]: fill 1 to 4 by value in 0
powfs.notf=[0]: fill 1 to 4 by value in 0
powfs.psfout=[0]: fill 1 to 4 by value in 0
powfs.pistatout=[0]: fill 1 to 4 by value in 0
powfs.pistatstart=[20]: fill 1 to 4 by value in 0
powfs.pistatstc=[0]: fill 1 to 4 by value in 0
powfs.phytype_sim2=[1]: fill 1 to 4 by value in 0
powfs.r0=[-1]: fill 1 to 4 by value in 0
powfs.L0=[-1]: fill 1 to 4 by value in 0
powfs.mtchcpl=[1]: fill 1 to 4 by value in 0
powfs.mtchadp=[0]: fill 1 to 4 by value in 0
powfs.mtchfft=[0]: fill 1 to 4 by value in 0
powfs.cogthres=[0]: fill 1 to 4 by value in 0
powfs.cogoff=[0]: fill 1 to 4 by value in 0
powfs.ncpa_method=[-1]: fill 1 to 4 by value in 0
powfs.i0scale=[0]: fill 1 to 4 by value in 0
powfs.i0save=[0]: fill 1 to 4 by value in 0
powfs.i0load=[""]: Fill 1 to 4 by value in 0
powfs.sigscale=[1]: fill 1 to 4 by value in 0
powfs.gradscale=[1]: fill 1 to 4 by value in 0
powfs.moao=[-1]: fill 1 to 4 by value in 0
powfs.dither_ogsingle=[0]: fill 1 to 4 by value in 0
powfs.dither_gdrift=[0]: fill 1 to 4 by value in 0
powfs.dither_glpf=[1]: fill 1 to 4 by value in 0
powfs.zoomshare=[1]: fill 1 to 4 by value in 0
powfs.zoomgain=[0.5]: fill 1 to 4 by value in 0
powfs.zoomgain_drift=[0.5]: fill 1 to 4 by value in 0
powfs.zoomset=[1]: fill 1 to 4 by value in 0
powfs.qe=[""]: Fill 1 to 4 by value in 0
powfs.frs=[0]: fill 1 to 4 by value in 0
powfs.noisy=[1]: fill 1 to 4 by value in 0
There are 2 powfs with LLT. 
loaded  24 ( 24 new) records from '/scr2/bpeck/work/hybrid/./keck_llt_CL.conf'
loaded  24 ( 23 new) records from '/scr2/bpeck/work/hybrid/./keck_llt_CL.conf'
wfs.fitwt=[0]: fill 1 to 4 by value in 0
wfs.sabad=[""]: Fill 1 to 4 by value in 0
wfs.delta_hs=[0]: fill 1 to 4 by value in 0
wfs.delta_hc=[0]: fill 1 to 4 by value in 0
powfs[0].wvlwts is 1x1
powfs[0].siglevs is 1x1
powfs[1].wvlwts is 1x1
powfs[1].siglevs is 1x1
powfs[2].wvlwts is 1x1
powfs[2].siglevs is 1x1
powfs[3].wvlwts is 1x1
powfs[3].siglevs is 1x1
atmr.os=[2]: fill 1 to 14 by value in 0
save.ints=0: fill 1 to 4 by value in 0
save.wfsopd=0: fill 1 to 4 by value in 0
save.grad=0: fill 1 to 4 by value in 0
save.gradnf=0: fill 1 to 4 by value in 0
save.gradpsol=0: fill 1 to 4 by value in 0
save.gradgeom=0: fill 1 to 4 by value in 0
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs 0: Adjusting dx from 0.0078125 to 0.00797222. 
powfs 1: Adjusting dx from 0.0078125 to 0.00797222. 
Warning(parms.c:1896): There are multiple LGS type. parms->ilgspowfs points to the first one
powfs 3: Adjusting dx from 0.03125 to 0.0287. 
powfs 3 is TWFS for powfs 0
dtrat_lo=1, dtrat_lo2=1, dtrat_lof=-1
Tomography Layer 13 is above high order guide star and therefore dropped.
atm layer 0 is maped to atmr 0
atm layer 1 is maped to atmr 1
atm layer 2 is maped to atmr 2
atm layer 3 is maped to atmr 3
atm layer 4 is maped to atmr 4
atm layer 5 is maped to atmr 5
atm layer 6 is maped to atmr 6
atm layer 7 is maped to atmr 7
atm layer 8 is maped to atmr 8
atm layer 9 is maped to atmr 9
atm layer 10 is maped to atmr 10
atm layer 11 is maped to atmr 11
atm layer 12 is maped to atmr 12
atm layer 13 is maped to atmr 12
Warning(parms.c:2246): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2246): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2246): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
Warning(parms.c:2290): Two high order POWFS with different hs found: 99136.8 and 19982.1. Please double check the results.
dm 0: stroke=300 um is provided in micron.
dm 0: assume ia stroke=20 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
Disable tomo.ahst_focus.
Lock Res_1.lock success.
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 462 of 490 supplied keys
Warning(readcfg.c:191): key "dm.dratio" is not recognized, value is [1]
Warning(readcfg.c:191): key "ncpa.calib" is not recognized, value is 0
Warning(readcfg.c:191): key "ncpa.hs" is not recognized, value is []
Warning(readcfg.c:191): key "ncpa.preload" is not recognized, value is 0
Warning(readcfg.c:191): key "ncpa.rmsci" is not recognized, value is 0
Warning(readcfg.c:191): key "ncpa.thetax" is not recognized, value is []
Warning(readcfg.c:191): key "ncpa.thetay" is not recognized, value is []
Warning(readcfg.c:191): key "ncpa.ttr" is not recognized, value is 0
Warning(readcfg.c:191): key "ncpa.wt" is not recognized, value is []
Warning(readcfg.c:191): key "powfs0_llt.dhs" is not recognized, value is 10000
Warning(readcfg.c:191): key "powfs0_llt.fcfsm" is not recognized, value is 0
Warning(readcfg.c:191): key "powfs0_llt.na_fit_dh" is not recognized, value is 500
Warning(readcfg.c:191): key "powfs0_llt.na_fit_maxit" is not recognized, value is 0
Warning(readcfg.c:191): key "powfs0_llt.na_fit_svdthres" is not recognized, value is 1e-3
Warning(readcfg.c:191): key "powfs0_llt.na_interp" is not recognized, value is 1
Warning(readcfg.c:191): key "powfs0_llt.na_smooth" is not recognized, value is 1
Warning(readcfg.c:191): key "powfs0_llt.na_thres" is not recognized, value is 100
Warning(readcfg.c:191): key "powfs0_llt.nhs" is not recognized, value is 1
Warning(readcfg.c:191): key "powfs1_llt.dhs" is not recognized, value is 10000
Warning(readcfg.c:191): key "powfs1_llt.fcfsm" is not recognized, value is 0
Warning(readcfg.c:191): key "powfs1_llt.na_fit_dh" is not recognized, value is 500
Warning(readcfg.c:191): key "powfs1_llt.na_fit_maxit" is not recognized, value is 0
Warning(readcfg.c:191): key "powfs1_llt.na_fit_svdthres" is not recognized, value is 1e-3
Warning(readcfg.c:191): key "powfs1_llt.na_interp" is not recognized, value is 1
Warning(readcfg.c:191): key "powfs1_llt.na_smooth" is not recognized, value is 1
Warning(readcfg.c:191): key "powfs1_llt.na_thres" is not recognized, value is 100
Warning(readcfg.c:191): key "powfs1_llt.nhs" is not recognized, value is 1
Warning(readcfg.c:191): key "sim.dtret" is not recognized, value is 1/1500
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 13 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.314
    layer 1: ht=     17 m, wt= 0.160
    layer 2: ht=     35 m, wt= 0.043
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.022
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.111
    layer 10: ht=   5022 m, wt= 0.150
    layer 11: ht=   9238 m, wt= 0.097
    layer 12: ht=  13856 m, wt= 0.078
[00;00mThere are 4 powfs[00;00m
  powfs 0: Order 39, LGS at 99.1 km. Sampling 1/125.436 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    Gtilt in reconstruction. Geomtric optics start at 0 with gtilt [00;00m(noisy)[00;00m
  powfs 1: Order 39, LGS at  20 km. Sampling 1/125.436 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    Gtilt in reconstruction. Geomtric optics start at 0 with gtilt [00;00m(noisy)[00;00m
  powfs 2: Order  1, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Gtilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs 3: Order 39, NGS at inf km. Sampling 1/34.8432 m. Thres 50%. 
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt [00;00m(noisy)[00;00m
[00;00mThere are 4 wfs[00;00m
    wfs 0: type 0, at (   0.00,    0.00) arcsec,  99 km, siglev is 1099.85 bkgrnd is 1.5
    wfs 1: type 1, at (   0.00,    0.00) arcsec,  20 km, siglev is 1099.85 bkgrnd is 1.5
    wfs 2: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 64529 bkgrnd is 8.273
    wfs 3: type 3, at (   0.00,    0.00) arcsec, inf km, siglev is 147933 bkgrnd is 25.25
[00;00mThere are 1 DMs[00;00m
  DM 0 at    0km, actuator pitch 0.287m, offset   0, with 300.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mNo[00;00m preconditioner, [00;00m120[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 1 fit directions[00;00m
    Fit 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 3000, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	121.2 MiB.
Warning(sock.c:515): connect locally (/home/bpeck/.aos/tmp/anshar/scheduler) failed: Connection refused. 
CUDA: minimum memory requirement is 0.2GB
Lock /home/bpeck/.aos/tmp/anshar/gpu.lock success.
GPU 0 has 7.8GB free, 7.9GB total device memory.
GPU 1 has 7.9GB free, 7.9GB total device memory.
Using GPU 0 1
EVL 0 --> GPU 0
RECON --> GPU 1
WFS 0 --> GPU 1
WFS 1 --> GPU 1
WFS 2 --> GPU 1
WFS 3 --> GPU 1
Use 2 GPUs for  WFS Tomo Fit Evl

*** Preparation started at 2024/06/04 16:04:33 in anshar. ***

Using OpenMP version 201511 with 64 threads
TOMOSCALE=1e-12
set dsvd_ext to gpu_dsvd
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:479): 53978 points not covered by input screen
Warning(sock.c:515): connect locally (/home/bpeck/.aos/tmp/anshar/scheduler) failed: Connection refused. 
 ->maos.c:446->setup.c:148->aper.c:76->utils.c:489->accphi.c:480
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.9516723282638
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.9516723282638
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.9516723282638
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.9516723282638
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.9516723282638
setup_aper takes 0.254788 seconds.
After setup_aper:	1309.5 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 36 points in each subaperture of 0.287m.
offsetx=-1.35, offsety=-1.35, order=39, orderpad=41

Signal caught: Interrupt (2)
[2024/06/04 16:04:33]default_signal_handler: Call signal_handler 0x42f650
maos_signal_handler: Interrupt (2)
[2024/06/04 16:04:33]default_signal_handler: Signal handler returns 0
[2024/06/04 16:04:33]default_signal_handler: Propagate signal
