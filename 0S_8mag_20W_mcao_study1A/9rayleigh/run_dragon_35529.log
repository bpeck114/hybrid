/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/maos -o 0S_8mag_20W_mcao_study1A/9rayleigh -c A_mcao_hybrid.conf plot.all=1 plot.setup=1 -O powfs.nwfs=[0 9 3 1] wfs.thetax=[ 60.0 45.96 10.42 -30.0 -56.38 -56.38 -30.0 10.42 45.96 5 -2.5 -2.5 0] wfs.thetay=[ 0.0 38.57 59.09 51.96 20.52 -20.52 -51.96 -59.09 -38.57 0 4.33 -4.33 0] powfs0_llt.ox = []*6.5 powfs0_llt.oy=[]*6.5 powfs1_llt.ox = [1.0 0.77 0.17 -0.5 -0.94 -0.94 -0.5 0.17 0.77]*6.5 powfs1_llt.oy=[0.0 0.64 0.98 0.87 0.34 -0.34 -0.87 -0.98 -0.64]*6.5 powfs.siglev=[32.84 28.17 61320.53 19.89] powfs.bkgrnd=[0.1 0.1 2.6 0.0] powfs.nearecon=[265.78 265.78 1.98 407.28] 
Output folder is '0S_8mag_20W_mcao_study1A/9rayleigh'.
SRC: /u/bpeck/code/maos v2.9 2.9
BUILT: /u/bpeck/code/maos/build by CLANG (v14.0.0) on 2024/03/22 14:52:24 CPU(F64,+O3) w/o CUDA
Launched at 2024/06/27 09:23:49 in dragon with PID 35529.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/A_mcao_hybrid.conf
Warning(path.c:48): Path not found: path=/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/bin; abspath=/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/bin; Ignored.
Warning(path.c:48): Path not found: path=/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/atm; abspath=/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
Warning(readcfg.c:399): sim.ncpa_calib has been renamed to ncpa.calib.
Warning(readcfg.c:399): sim.ncpa_ttr has been renamed to ncpa.ttr.
Warning(readcfg.c:399): sim.ncpa_thetax has been renamed to ncpa.thetax.
Warning(readcfg.c:399): sim.ncpa_thetay has been renamed to ncpa.thetay.
Warning(readcfg.c:399): sim.ncpa_wt has been renamed to ncpa.wt.
Warning(readcfg.c:399): sim.ncpa_hs has been renamed to ncpa.hs.
loaded 139 (133 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_sim.conf'
loaded  19 ( 19 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./dm_none.conf'
loaded  19 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_DM1.conf'
loaded  19 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_DM2.conf'
loaded  19 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_DM3.conf'
loaded   0 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./atm_mk13n50p_ground_detail.conf'
loaded  69 ( 69 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./powfs_common.conf'
loaded  44 ( 38 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./powfs_none.conf'
loaded  45 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_shwfs_lgs.conf'
loaded  46 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_shwfs_lgs_R20.conf'
loaded  45 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_wfs_hybrid_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/u/bpeck/code/maos/config/maos/recon.conf'
loaded  80 ( 80 new) records from '/u/bpeck/code/maos/config/maos/dbg.conf'
loaded   4 (  4 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_fit.conf'
loaded  43 ( 10 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/A_mcao_hybrid.conf'
Overriding plot.all            	0 --> 1
Overriding plot.setup          	0 --> 1
Overriding powfs.nwfs          	[0 1 1 1] --> [0 9 3 1]
Overriding wfs.thetax          	[0 5 -2.5 -2.5 0] --> [60.0 45.96 10.42 -30.0 -56.38 -56.38 -30.0 10.42 45.96 5 -2.5 -2.5 0]
Overriding wfs.thetay          	[0 0 4.33 -4.33 0] --> [0.0 38.57 59.09 51.96 20.52 -20.52 -51.96 -59.09 -38.57 0 4.33 -4.33 0]
Overriding powfs1_llt.ox       	[0]*6.5 --> [1.0 0.77 0.17 -0.5 -0.94 -0.94 -0.5 0.17 0.77]*6.5
Overriding powfs1_llt.oy       	[0]*6.5 --> [0.0 0.64 0.98 0.87 0.34 -0.34 -0.87 -0.98 -0.64]*6.5
Overriding powfs.siglev        	[0 28.17 64.52903 147933.02] --> [32.84 28.17 61320.53 19.89]
Overriding powfs.bkgrnd        	[0 0.1 8.273 25.25] --> [0.1 0.1 2.6 0.0]
Overriding powfs.nearecon      	[0 43 1.93 1.28] --> [265.78 265.78 1.98 407.28]
loaded  12 (  0 new) records from 'command line'
loaded  23 ( 23 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_llt_CL.conf'
loaded  23 ( 23 new) records from '/System/Volumes/Data/mnt/g2/scratch/bpeck/mcao/hybrid/./keck_llt_CL.conf'
draw_helper started
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0077. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs2: Adjusting dx from 0.03125 to 0.0385. 
powfs2 is TWFS for powfs0
Warning(parms.c:2297): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2297): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2297): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=300 um is provided in micron.
dm 0: assume ia stroke=20 um is provided in micron.
dm 1: stroke=300 um is provided in micron.
dm 1: assume ia stroke=20 um is provided in micron.
dm 2: stroke=300 um is provided in micron.
dm 2: assume ia stroke=20 um is provided in micron.
There are 1 valid simulation seeds:  1
Output PSF for 10 directions
Used 475 of 475 supplied keys
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 13 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.314
    layer 1: ht=     17 m, wt= 0.160
    layer 2: ht=     35 m, wt= 0.043
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.022
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.111
    layer 10: ht=   5022 m, wt= 0.150
    layer 11: ht=   9238 m, wt= 0.097
    layer 12: ht=  13856 m, wt= 0.078
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 72, LGS at  20 km. Sampling 1/129.87 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 4x4 @ 3000x3000 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.32e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  1, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Gtilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 72, NGS at inf km. Sampling 1/25.974 m. Thres 50%. 
    CCD image is 3x3 @ 1500x1500 mas, blur 0% (sigma), 1.5Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  60.00,    0.00) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 1: type 0, at (  45.96,   38.57) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 2: type 0, at (  10.42,   59.09) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 3: type 0, at ( -30.00,   51.96) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 4: type 0, at ( -56.38,   20.52) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 5: type 0, at ( -56.38,  -20.52) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 6: type 0, at ( -30.00,  -51.96) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 7: type 0, at (  10.42,  -59.09) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 8: type 0, at (  45.96,  -38.57) arcsec,  20 km, siglev is 24.3959 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    0.00) arcsec, inf km, siglev is 61320.5 bkgrnd is 2.6
    wfs 10: type 1, at (  -2.50,    4.33) arcsec, inf km, siglev is 61320.5 bkgrnd is 2.6
    wfs 11: type 1, at (  -2.50,   -4.33) arcsec, inf km, siglev is 61320.5 bkgrnd is 2.6
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 19890 bkgrnd is 0
[00;00mThere are 3 DMs[00;00m
  DM 0 at    0km, actuator pitch 0.154m, offset   0, with 300.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.154m, offset   0, with 300.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.154m, offset   0, with 300.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mNo[00;00m preconditioner, [00;00m40[00;00m iterations, ad hoc split tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (   7.50,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,    7.50) arcsec
    Fit 3: weight is 0.111, at (  -7.50,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,   -7.50) arcsec
    Fit 5: weight is 0.028, at (   7.50,    7.50) arcsec
    Fit 6: weight is 0.028, at (  -7.50,    7.50) arcsec
    Fit 7: weight is 0.028, at (  -7.50,   -7.50) arcsec
    Fit 8: weight is 0.028, at (   7.50,   -7.50) arcsec
[00;00mThere are 10 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 0.100, at (   0.00,    0.00) arcsec
    Evl 1: weight is 0.100, at (   5.00,    0.00) arcsec
    Evl 2: weight is 0.100, at (  10.00,    0.00) arcsec
    Evl 3: weight is 0.100, at (  15.00,    0.00) arcsec
    Evl 4: weight is 0.100, at (  20.00,    0.00) arcsec
    Evl 5: weight is 0.100, at (  25.00,    0.00) arcsec
    Evl 6: weight is 0.100, at (  30.00,    0.00) arcsec
    Evl 7: weight is 0.100, at (  35.00,    0.00) arcsec
    Evl 8: weight is 0.100, at (  45.00,    0.00) arcsec
    Evl 9: weight is 0.100, at (  60.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1000, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	2.1 MiB.

*** Preparation started at 2024/06/27 09:23:49 in dragon. ***

Using thread pool with 32 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108578 points not covered by input screen
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232824563
After setup_aper:	88.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.154m.
There are 3142 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 176 points in each subaperture of 11m.
There are 1 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 4 points in each subaperture of 0.154m.
There are 3105 valid subaperture.
After setup_powfs_init:	204.4 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 147x147, with sampling of 0.08m (not square)
    DM 0: grid is 75 x 75
    DM 1: grid is 89 x 79
    DM 2: grid is 97 x 81
FLOC is 147x147, with sampling of 0.08m (not square)
Tomography grid is not square:
    layer 0: xloc grid is 147 x 147, sampling is 0.077 m, 17069 points
    layer 1: xloc grid is 147 x 147, sampling is 0.077 m, 17119 points
    layer 2: xloc grid is 147 x 147, sampling is 0.077 m, 17155 points
    layer 3: xloc grid is 147 x 147, sampling is 0.077 m, 17179 points
    layer 4: xloc grid is 148 x 147, sampling is 0.076 m, 17386 points
    layer 5: xloc grid is 150 x 149, sampling is 0.076 m, 17626 points
    layer 6: xloc grid is 150 x 149, sampling is 0.076 m, 17842 points
    layer 7: xloc grid is 152 x 151, sampling is 0.075 m, 18078 points
    layer 8: xloc grid is 153 x 151, sampling is 0.075 m, 18313 points
    layer 9: xloc grid is 158 x 155, sampling is 0.073 m, 19448 points
    layer 10: xloc grid is 223 x 201, sampling is 0.058 m, 36293 points
    layer 11: xloc grid is 342 x 285, sampling is 0.041 m, 79966 points
    layer 12: xloc grid is 662 x 513, sampling is 0.024 m, 278882 points
Setting up surface OPD

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
Warning(mkdtf.c:365): Wrong focus!
Warning(mkdtf.c:374): Sodium profile is cropped by up to inf% for 3186 subaps. Increase powfs.pixpsa or powfs.notf.
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.574143"
Downlink FWHM (illt 0, iwvl 0) is 1.25734"
Warning(mkdtf.c:374): Sodium profile is cropped by up to inf% for 3186 subaps. Increase powfs.pixpsa or powfs.notf.
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1575: (  4.8,  -0.1) m, (30000.00, 30000.00) mas
    1568: (  3.7,  -0.1) m, (30000.00, 30000.00) mas
    1561: (  2.6,  -0.1) m, (30000.00, 30000.00) mas
    1554: (  1.6,  -0.1) m, (30000.00, 30000.00) mas
    1552: (  1.3,  -0.1) m, (30000.00, 30000.00) mas
    1109: ( -0.6,  -1.4) m, (30000.00, 30000.00) mas
    1548: ( -1.8,  -0.1) m, (30000.00, 30000.00) mas
    1541: ( -2.9,  -0.1) m, (30000.00, 30000.00) mas
    1534: ( -4.0,  -0.1) m, (30000.00, 30000.00) mas
    1527: ( -5.1,  -0.1) m, (30000.00, 30000.00) mas
    1525: ( -5.4,  -0.1) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
    2681: (  3.6,   2.9) m, (30000.00, 30000.00) mas
    2419: (  2.6,   2.2) m, (30000.00, 30000.00) mas
    2122: (  1.7,   1.4) m, (30000.00, 30000.00) mas
    1883: (  0.9,   0.8) m, (30000.00, 30000.00) mas
    1115: (  0.3,  -1.4) m, (30000.00, 30000.00) mas
    1221: ( -1.2,  -1.1) m, (30000.00, 30000.00) mas
     978: ( -2.0,  -1.7) m, (30000.00, 30000.00) mas
     739: ( -2.7,  -2.3) m, (30000.00, 30000.00) mas
     478: ( -3.7,  -3.1) m, (30000.00, 30000.00) mas
     127: ( -3.1,  -4.3) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
    2972: (  0.6,   4.0) m, (30000.00, 30000.00) mas
    2711: (  0.5,   3.1) m, (30000.00, 30000.00) mas
    2456: (  0.3,   2.3) m, (30000.00, 30000.00) mas
    2112: (  0.2,   1.4) m, (30000.00, 30000.00) mas
    1438: ( -1.4,  -0.4) m, (30000.00, 30000.00) mas
    1050: ( -0.3,  -1.5) m, (30000.00, 30000.00) mas
     808: ( -0.4,  -2.1) m, (30000.00, 30000.00) mas
     498: ( -0.6,  -3.1) m, (30000.00, 30000.00) mas
      25: ( -0.9,  -4.8) m, (30000.00, 30000.00) mas
       1: ( -2.4,  -4.9) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
    3033: ( -2.6,   4.3) m, (30000.00, 30000.00) mas
    2952: ( -2.4,   4.0) m, (30000.00, 30000.00) mas
    2646: ( -1.8,   2.9) m, (30000.00, 30000.00) mas
    2393: ( -1.4,   2.2) m, (30000.00, 30000.00) mas
    1987: ( -0.7,   1.1) m, (30000.00, 30000.00) mas
    1665: (  1.3,   0.2) m, (30000.00, 30000.00) mas
    1117: (  0.6,  -1.4) m, (30000.00, 30000.00) mas
     818: (  1.1,  -2.1) m, (30000.00, 30000.00) mas
     462: (  1.7,  -3.2) m, (30000.00, 30000.00) mas
     162: (  2.3,  -4.3) m, (30000.00, 30000.00) mas
      43: (  2.6,  -4.8) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
    2203: ( -4.6,   1.7) m, (30000.00, 30000.00) mas
    2142: ( -4.6,   1.6) m, (30000.00, 30000.00) mas
    1920: ( -2.9,   0.9) m, (30000.00, 30000.00) mas
    1773: ( -1.7,   0.5) m, (30000.00, 30000.00) mas
    1774: ( -1.5,   0.5) m, (30000.00, 30000.00) mas
    1936: (  0.8,   0.9) m, (30000.00, 30000.00) mas
    1385: (  1.4,  -0.6) m, (30000.00, 30000.00) mas
    1283: (  2.2,  -0.9) m, (30000.00, 30000.00) mas
    1236: (  2.6,  -1.1) m, (30000.00, 30000.00) mas
    1019: (  4.3,  -1.7) m, (30000.00, 30000.00) mas
    1409: (  5.1,  -0.6) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
    1089: ( -3.7,  -1.4) m, (30000.00, 30000.00) mas
    1153: ( -3.2,  -1.2) m, (30000.00, 30000.00) mas
    1322: ( -2.0,  -0.7) m, (30000.00, 30000.00) mas
    1380: ( -1.5,  -0.6) m, (30000.00, 30000.00) mas
    2050: (  0.0,   1.3) m, (30000.00, 30000.00) mas
    1779: (  1.4,   0.5) m, (30000.00, 30000.00) mas
    1892: (  2.3,   0.8) m, (30000.00, 30000.00) mas
    2073: (  3.6,   1.3) m, (30000.00, 30000.00) mas
    2137: (  4.0,   1.4) m, (30000.00, 30000.00) mas
    1747: (  5.1,   0.3) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
      89: ( -2.6,  -4.4) m, (30000.00, 30000.00) mas
     297: ( -2.1,  -3.7) m, (30000.00, 30000.00) mas
     645: ( -1.5,  -2.6) m, (30000.00, 30000.00) mas
    1046: ( -0.9,  -1.5) m, (30000.00, 30000.00) mas
    1169: ( -0.7,  -1.2) m, (30000.00, 30000.00) mas
    1933: ( -0.9,   0.9) m, (30000.00, 30000.00) mas
    2116: (  0.8,   1.4) m, (30000.00, 30000.00) mas
    2239: (  0.9,   1.7) m, (30000.00, 30000.00) mas
    2617: (  1.6,   2.8) m, (30000.00, 30000.00) mas
    2858: (  2.0,   3.6) m, (30000.00, 30000.00) mas
    3066: (  2.5,   4.3) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
       9: (  0.8,  -4.9) m, (30000.00, 30000.00) mas
     192: (  0.6,  -4.1) m, (30000.00, 30000.00) mas
     404: (  0.5,  -3.4) m, (30000.00, 30000.00) mas
     708: (  0.3,  -2.4) m, (30000.00, 30000.00) mas
    1053: (  0.2,  -1.5) m, (30000.00, 30000.00) mas
    1663: ( -1.4,   0.2) m, (30000.00, 30000.00) mas
    2048: ( -0.3,   1.3) m, (30000.00, 30000.00) mas
    2346: ( -0.4,   2.0) m, (30000.00, 30000.00) mas
    2654: ( -0.6,   2.9) m, (30000.00, 30000.00) mas
    3116: ( -0.9,   4.6) m, (30000.00, 30000.00) mas
    3111: ( -2.3,   4.6) m, (30000.00, 30000.00) mas
sa index   location       noise equivalent angle
     475: (  3.7,  -3.2) m, (30000.00, 30000.00) mas
     674: (  2.9,  -2.6) m, (30000.00, 30000.00) mas
     943: (  2.0,  -1.8) m, (30000.00, 30000.00) mas
    1176: (  1.3,  -1.2) m, (30000.00, 30000.00) mas
    1226: (  1.1,  -1.1) m, (30000.00, 30000.00) mas
    1992: (  0.5,   1.1) m, (30000.00, 30000.00) mas
    1930: ( -1.4,   0.9) m, (30000.00, 30000.00) mas
    2039: ( -1.7,   1.3) m, (30000.00, 30000.00) mas
    2332: ( -2.6,   2.0) m, (30000.00, 30000.00) mas
    2584: ( -3.5,   2.8) m, (30000.00, 30000.00) mas
    2989: ( -3.1,   4.2) m, (30000.00, 30000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 10x10 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Low order modes: nmod=6, mffocus=1, ahst_focus=1, indps=2, indastig=0
Low order control includes WFS 9 10 11
Recon NEA: cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) cmf(30000.00) geom(2.27) geom(2.27) geom(2.27) mf(9.31)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
    dm 0, mode 1: there are 32 slave actuators
    dm 1, mode 1: there are 846 slave actuators
    dm 2, mode 1: there are 1286 slave actuators
Before assembling fit matrix:	3166.3 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5995.2 MiB.
After setup_recon:	5995.2 MiB.

*** Simulation started at 2024/06/27 09:24:13 in dragon. ***

Running seed 1
Converting windshake PSD to time series.
DM cache with grid 1/25.974m 1/25.974m 1/25.974m
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /u/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6143.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT Split     HIGH   TT    LOW     Timing 
Step     0: OL  856.5  100.7  OA  849.8  37.3 CL  856.5 100.7 Split   832.2  55.3  202.7 nm  0.301 s
Displaying content of inn_A:
Cols 0 to 0
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
Displaying content of inn_B:
Cols 0 to 0
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
        nan
Error(matmath.c:112): X(inn): NaN found

Signal caught: User defined signal 2: 31 (31)
maos_signal_handler: User defined signal 2: 31 (31)
